<!-- Guía completa de Express.js en un solo archivo HTML -->
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Express.js para Backend: Guía Completa</title>
    <meta name="description"
        content="Guía introductoria y práctica de Express.js para Node.js en el desarrollo Backend: instalación, routing, middlewares, seguridad, autenticación, errores, pruebas, despliegue y mejores prácticas." />
    <style>
        :root {
            --bg: #0f1220;
            --panel: #14182b;
            --panel-2: #101429;
            --text: #e8ecff;
            --muted: #a8b2d1;
            --brand: #6ea8fe;
            --brand-2: #4cc9f0;
            --ok: #8be9a3;
            --warn: #ffd166;
            --err: #ff6b6b;
            --code-bg: #0b0e1a;
            --border: #252a40;
            --shadow: 0 8px 24px rgba(0, 0, 0, .35);
        }

        * {
            box-sizing: border-box
        }

        html,
        body {
            height: 100%
        }

        body {
            margin: 0;
            background: linear-gradient(180deg, #0d1020 0%, #0b0e1a 100%);
            color: var(--text);
            font: 15px/1.6 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
        }

        a {
            color: var(--brand)
        }

        header {
            position: sticky;
            top: 0;
            z-index: 20;
            background: rgba(16, 20, 41, .75);
            backdrop-filter: saturate(120%) blur(8px);
            border-bottom: 1px solid var(--border);
        }

        .bar {
            max-width: 1200px;
            margin: 0 auto;
            padding: 12px 16px;
            display: flex;
            gap: 12px;
            align-items: center;
            justify-content: space-between;
        }

        .title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
            font-size: 18px;
        }

        .title .badge {
            font-size: 12px;
            color: #0b0e1a;
            background: linear-gradient(135deg, var(--brand), var(--brand-2));
            padding: 2px 8px;
            border-radius: 999px
        }

        .search {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--panel);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 6px 10px;
            min-width: 320px;
            flex: 1;
            max-width: 520px;
        }

        .search input {
            width: 100%;
            background: transparent;
            border: none;
            outline: none;
            color: var(--text)
        }

        .layout {
            max-width: 1200px;
            margin: 0 auto;
            padding: 18px 16px;
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 18px;
        }

        nav {
            position: sticky;
            top: 64px;
            align-self: start;
            background: var(--panel);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 16px;
            max-height: calc(100vh - 88px);
            overflow: auto;
            box-shadow: var(--shadow)
        }

        nav h3 {
            margin: 6px 0 10px 0;
            font-size: 13px;
            color: var(--muted);
            text-transform: uppercase;
            letter-spacing: .08em
        }

        nav a {
            display: block;
            color: var(--text);
            text-decoration: none;
            padding: 6px 8px;
            border-radius: 8px;
            font-size: 14px
        }

        nav a:hover {
            background: var(--panel-2)
        }

        nav a.active {
            background: linear-gradient(135deg, rgba(110, 168, 254, .15), rgba(76, 201, 240, .12));
            border: 1px solid rgba(110, 168, 254, .35)
        }

        main {
            background: var(--panel);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 20px;
            box-shadow: var(--shadow)
        }

        section {
            padding: 18px 6px;
            border-bottom: 1px dashed var(--border)
        }

        section:last-child {
            border-bottom: none
        }

        h1 {
            font-size: 28px;
            margin: 6px 0 16px
        }

        h2 {
            font-size: 22px;
            margin: 18px 0 8px
        }

        h3 {
            font-size: 18px;
            margin: 14px 0 6px
        }

        p,
        li {
            color: #dbe2ff
        }

        .muted {
            color: var(--muted)
        }

        .pill {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 999px;
            background: var(--panel-2);
            border: 1px solid var(--border);
            font-size: 12px;
            color: var(--muted)
        }

        .grid {
            display: grid;
            gap: 12px
        }

        .grid.cols-2 {
            grid-template-columns: repeat(2, 1fr)
        }

        .grid.cols-3 {
            grid-template-columns: repeat(3, 1fr)
        }

        .card {
            background: var(--panel-2);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 12px
        }

        .hint {
            border-left: 4px solid var(--brand);
            padding: 8px 12px;
            background: rgba(110, 168, 254, .08);
            border-radius: 8px
        }

        .warn {
            border-left: 4px solid var(--warn);
            padding: 8px 12px;
            background: rgba(255, 209, 102, .08);
            border-radius: 8px
        }

        .ok {
            border-left: 4px solid var(--ok);
            padding: 8px 12px;
            background: rgba(139, 233, 163, .08);
            border-radius: 8px
        }

        pre {
            background: var(--code-bg);
            padding: 12px;
            border-radius: 10px;
            border: 1px solid var(--border);
            overflow: auto;
            position: relative
        }

        code {
            font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
            font-size: 13px;
            color: #e9f2ff
        }

        .copy {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(255, 255, 255, .06);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer
        }

        .kbd {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 6px;
            background: #0f1220;
            border: 1px solid var(--border);
            color: var(--muted);
            font-size: 12px
        }

        footer {
            color: var(--muted);
            font-size: 13px;
            padding: 24px 0;
            text-align: center
        }

        @media (max-width: 980px) {
            .layout {
                grid-template-columns: 1fr
            }

            nav {
                position: relative;
                top: auto;
                max-height: none
            }

            .search {
                min-width: unset
            }

            .grid.cols-2 {
                grid-template-columns: 1fr
            }

            .grid.cols-3 {
                grid-template-columns: 1fr
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="bar">
            <div class="title">
                <span>Express.js para Backend</span>
                <span class="badge">Guía Completa</span>
            </div>
            <div class="search" role="search">
                <span class="muted">Buscar</span>
                <input id="search" type="search" placeholder="Rutas, middlewares, seguridad, JWT, despliegue..."
                    aria-label="Buscar en la guía" />
            </div>
        </div>
    </header>

    <div class="layout">
        <nav id="toc" aria-label="Tabla de contenidos">
            <h3>Contenido</h3>
            <a href="#intro">Introducción</a>
            <a href="#requisitos">Requisitos</a>
            <a href="#instalacion">Instalación y Hola Mundo</a>
            <a href="#estructura">Estructura de proyecto</a>
            <a href="#config-env">Configuración y .env</a>
            <a href="#routing">Routing</a>
            <a href="#middleware">Middlewares</a>
            <a href="#req-res">Request/Response</a>
            <a href="#errores">Manejo de errores</a>
            <a href="#validacion">Validación y sanitización</a>
            <a href="#seguridad">Seguridad</a>
            <a href="#auth">Autenticación y autorización (JWT)</a>
            <a href="#estaticos-templates">Archivos estáticos y templates</a>
            <a href="#db">Integración con bases de datos</a>
            <a href="#uploads">Subida de archivos</a>
            <a href="#testing">Pruebas</a>
            <a href="#logging">Logging</a>
            <a href="#rendimiento">Rendimiento y escalado</a>
            <a href="#deploy">Despliegue</a>
            <a href="#buenas-practicas">Buenas prácticas</a>
            <a href="#troubleshooting">Troubleshooting</a>
            <a href="#faq">FAQ</a>
            <a href="#recursos">Recursos</a>
        </nav>

        <main id="content">
            <section id="intro" tabindex="-1">
                <h1>Express.js: Introducción</h1>
                <p>Express es un framework minimalista para Node.js que facilita crear APIs y aplicaciones web.
                    Proporciona un sistema de routing, middlewares, utilidades de solicitud/respuesta y un ecosistema
                    amplio de librerías.</p>
                <div class="grid cols-3">
                    <div class="card">
                        <h3>Características</h3>
                        <ul>
                            <li>Enrutamiento sencillo y modular</li>
                            <li>Middlewares para transformar la petición/respuesta</li>
                            <li>Extensible con miles de paquetes NPM</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h3>Casos de uso</h3>
                        <ul>
                            <li>APIs REST/JSON</li>
                            <li>SSR con motores de plantillas</li>
                            <li>Gateways o BFF</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h3>Alternativas</h3>
                        <ul>
                            <li>Fastify, Koa, Hapi</li>
                            <li>NestJS (sobre Express/Fastify)</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="requisitos" tabindex="-1">
                <h2>Requisitos</h2>
                <ul>
                    <li>Node.js LTS y NPM</li>
                    <li>Conocimientos básicos de JavaScript (async/await)</li>
                    <li>Terminal y control de versiones (Git)</li>
                </ul>
            </section>

            <section id="instalacion" tabindex="-1">
                <h2>Instalación y Hola Mundo</h2>
                <ol>
                    <li>Inicializa proyecto:
                        <pre><button class="copy">Copiar</button><code>mkdir mi-api &amp;&amp; cd mi-api
npm init -y
npm i express
</code></pre>
                    </li>
                    <li>Crea index.js:
                        <pre><button class="copy">Copiar</button><code>// index.js
const express = require('express');
const app = express();

app.get('/', (req, res) =&gt; {
  res.send('Hola Express');
});

const PORT = process.env.PORT || 3000;
app.listen(PORT, () =&gt; console.log(`Servidor en http://localhost:${PORT}`));
</code></pre>
                    </li>
                    <li>Ejecuta:
                        <pre><button class="copy">Copiar</button><code>node index.js
</code></pre>
                    </li>
                </ol>
                <div class="hint">
                    Consejo: Usa nodemon para recargar automáticamente en desarrollo: <span class="kbd">npm i -D
                        nodemon</span> y en package.json: <span class="kbd">"dev": "nodemon index.js"</span>.
                </div>
            </section>

            <section id="estructura" tabindex="-1">
                <h2>Estructura de proyecto</h2>
                <pre><button class="copy">Copiar</button><code>mi-api/
├─ src/
│  ├─ app.js
│  ├─ routes/
│  ├─ controllers/
│  ├─ middlewares/
│  ├─ models/
│  ├─ services/
│  ├─ config/
│  └─ utils/
├─ tests/
├─ public/
├─ views/
├─ .env
├─ package.json
└─ README.md
</code></pre>
                <div class="grid cols-2">
                    <div class="card">
                        <h3>app.js (bootstrap)</h3>
                        <pre><button class="copy">Copiar</button><code>// src/app.js
const express = require('express');
const app = express();

app.use(express.json()); // JSON body parser
app.get('/health', (req,res) =&gt; res.json({ ok:true, ts:Date.now() }));

module.exports = app;
</code></pre>
                    </div>
                    <div class="card">
                        <h3>server.js</h3>
                        <pre><button class="copy">Copiar</button><code>// server.js
require('dotenv').config();
const app = require('./src/app');

const PORT = process.env.PORT || 3000;
app.listen(PORT, () =&gt; console.log(`Escuchando en http://localhost:${PORT}`));
</code></pre>
                    </div>
                </div>
                <div class="hint">
                    Scripts recomendados en package.json:
                    <pre><button class="copy">Copiar</button><code>{
  "scripts": {
    "dev": "nodemon server.js",
    "start": "node server.js",
    "test": "jest --runInBand"
  }
}
</code></pre>
                </div>
            </section>

            <section id="config-env" tabindex="-1">
                <h2>Configuración y variables de entorno</h2>
                <p>Usa dotenv para cargar valores desde .env sin subirlos al repositorio.</p>
                <pre><button class="copy">Copiar</button><code># .env
PORT=3000
NODE_ENV=development
JWT_SECRET=supersecreto
MONGO_URI=mongodb://localhost:27017/miapi
</code></pre>
                <pre><button class="copy">Copiar</button><code>// src/config/index.js
require('dotenv').config();

const config = {
  env: process.env.NODE_ENV || 'development',
  isProd: process.env.NODE_ENV === 'production',
  port: parseInt(process.env.PORT || '3000', 10),
  jwtSecret: process.env.JWT_SECRET,
  mongoUri: process.env.MONGO_URI
};

module.exports = { config };
</code></pre>
            </section>

            <section id="routing" tabindex="-1">
                <h2>Routing</h2>
                <div class="grid cols-2">
                    <div class="card">
                        <h3>Básico y parámetros</h3>
                        <pre><button class="copy">Copiar</button><code>const express = require('express');
const router = express.Router();

router.get('/users', (req,res) =&gt; res.json([]));
router.get('/users/:id', (req,res) =&gt; {
  const { id } = req.params; // parámetro de ruta
  res.json({ id });
});
router.get('/search', (req,res) =&gt; {
  const { q, page = 1 } = req.query; // query string
  res.json({ q, page: Number(page) });
});

module.exports = router;
</code></pre>
                    </div>
                    <div class="card">
                        <h3>App y routers</h3>
                        <pre><button class="copy">Copiar</button><code>// src/app.js
const express = require('express');
const usersRouter = require('./routes/users.router');
const app = express();

app.use(express.json());
app.use('/api/v1', usersRouter);

module.exports = app;
</code></pre>
                    </div>
                </div>
                <div class="hint">
                    Puedes encadenar métodos: <span class="kbd">router.route('/items').get(...).post(...)</span> y usar
                    patrones/regex en rutas.
                </div>
            </section>

            <section id="middleware" tabindex="-1">
                <h2>Middlewares</h2>
                <p>Funciones que reciben <span class="pill">req</span>, <span class="pill">res</span>, <span
                        class="pill">next</span> para leer/modificar el flujo.</p>
                <div class="grid cols-2">
                    <div class="card">
                        <h3>Integrados y propios</h3>
                        <pre><button class="copy">Copiar</button><code>const express = require('express');
const app = express();

app.use(express.json());          // parsea JSON
app.use(express.urlencoded({ extended: true })); // forms
app.use(express.static('public')); // archivos estáticos

// middleware propio (logger)
app.use((req,res,next) =&gt; {
  const started = Date.now();
  res.on('finish', () =&gt; {
    console.log(`${req.method} ${req.originalUrl} - ${res.statusCode} - ${Date.now()-started}ms`);
  });
  next();
});
</code></pre>
                    </div>
                    <div class="card">
                        <h3>Terceros</h3>
                        <pre><button class="copy">Copiar</button><code>const morgan = require('morgan');
const cors = require('cors');
const helmet = require('helmet');

app.use(helmet());
app.use(cors({ origin: 'http://localhost:5173', credentials: true }));
app.use(morgan('dev'));
</code></pre>
                    </div>
                </div>
            </section>

            <section id="req-res" tabindex="-1">
                <h2>Request y Response</h2>
                <div class="grid cols-2">
                    <div class="card">
                        <h3>req (solicitud)</h3>
                        <ul>
                            <li>req.params, req.query, req.body</li>
                            <li>req.headers, req.ip, req.method, req.path</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h3>res (respuesta)</h3>
                        <ul>
                            <li>res.status(code).json(data)</li>
                            <li>res.send(), res.end(), res.set()</li>
                            <li>res.redirect(), res.download()</li>
                        </ul>
                    </div>
                </div>
                <pre><button class="copy">Copiar</button><code>app.post('/echo', (req,res) =&gt; {
  const data = req.body;
  res.status(201).json({ received: data });
});
</code></pre>
            </section>

            <section id="errores" tabindex="-1">
                <h2>Manejo de errores</h2>
                <p>Define un manejador de errores con 4 argumentos para capturar excepciones y responder
                    consistentemente.</p>
                <pre><button class="copy">Copiar</button><code>// middleware de error
function errorHandler(err, req, res, next) {
  console.error(err);
  const status = err.status || 500;
  res.status(status).json({
    message: err.message || 'Error interno',
    stack: process.env.NODE_ENV === 'development' ? err.stack : undefined
  });
}

// 404
function notFound(req,res,next){
  res.status(404).json({ message: 'Recurso no encontrado' });
}

// wrapper async para propagar errores a next()
const asyncHandler = fn =&gt; (req,res,next) =&gt; Promise.resolve(fn(req,res,next)).catch(next);

// uso
app.get('/crash', (req,res) =&gt; { throw new Error('boom'); });
app.get('/async', asyncHandler(async (req,res) =&gt; {
  await new Promise(r =&gt; setTimeout(r,50));
  throw Object.assign(new Error('falló'), { status: 400 });
}));

app.use(notFound);
app.use(errorHandler);
</code></pre>
            </section>

            <section id="validacion" tabindex="-1">
                <h2>Validación y sanitización</h2>
                <p>Valida inputs para evitar errores y vulnerabilidades.</p>
                <pre><button class="copy">Copiar</button><code>// npm i express-validator
const { body, param, validationResult } = require('express-validator');

app.post('/users',
  body('email').isEmail().normalizeEmail(),
  body('password').isLength({ min: 8 }),
  (req,res,next) =&gt; {
    const errors = validationResult(req);
    if (!errors.isEmpty()) return res.status(400).json({ errors: errors.array() });
    res.status(201).json({ ok:true });
  }
);
</code></pre>
            </section>

            <section id="seguridad" tabindex="-1">
                <h2>Seguridad</h2>
                <ul>
                    <li>Headers seguros con Helmet</li>
                    <li>CORS: limita orígenes y credenciales</li>
                    <li>Rate limiting para mitigar abusos</li>
                    <li>Sanitización y validación de entrada</li>
                    <li>HTTPS en producción (reverse proxy)</li>
                </ul>
                <pre><button class="copy">Copiar</button><code>// npm i helmet cors express-rate-limit
const helmet = require('helmet');
const cors = require('cors');
const rateLimit = require('express-rate-limit');

app.set('trust proxy', 1); // si estás detrás de proxy: Heroku/Render/Nginx
app.use(helmet());
app.use(cors({ origin: ['https://mi-frontend.com'], credentials: true }));

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000,
  limit: 100,
  standardHeaders: 'draft-7',
  legacyHeaders: false
});
app.use('/api', limiter);
</code></pre>
            </section>

            <section id="auth" tabindex="-1">
                <h2>Autenticación y autorización (JWT)</h2>
                <div class="grid cols-2">
                    <div class="card">
                        <h3>Emitir token</h3>
                        <pre><button class="copy">Copiar</button><code>// npm i jsonwebtoken bcryptjs
const jwt = require('jsonwebtoken');
const bcrypt = require('bcryptjs');
const { config } = require('./config');

const USERS = [{ id:1, email:'admin@acme.com', passwordHash: bcrypt.hashSync('Secreto123',10), role:'admin' }];

app.post('/auth/login', async (req,res) =&gt; {
  const { email, password } = req.body;
  const user = USERS.find(u =&gt; u.email === email);
  if(!user || !bcrypt.compareSync(password, user.passwordHash)) {
    return res.status(401).json({ message:'Credenciales inválidas' });
  }
  const token = jwt.sign({ sub:user.id, role:user.role }, config.jwtSecret, { expiresIn:'1h' });
  res.json({ token });
});
</code></pre>
                    </div>
                    <div class="card">
                        <h3>Proteger rutas</h3>
                        <pre><button class="copy">Copiar</button><code>function auth(req,res,next){
  const authHeader = req.headers.authorization || '';
  const token = authHeader.startsWith('Bearer ') ? authHeader.slice(7) : null;
  if(!token) return res.status(401).json({ message:'No autorizado' });
  try{
    req.user = jwt.verify(token, process.env.JWT_SECRET);
    next();
  }catch(e){ return res.status(401).json({ message:'Token inválido' }); }
}

function allowRoles(...roles){
  return (req,res,next) =&gt; {
    if(!req.user || !roles.includes(req.user.role)) return res.status(403).json({ message:'Prohibido' });
    next();
  };
}

app.get('/admin/metrics', auth, allowRoles('admin'), (req,res) =&gt; {
  res.json({ uptime: process.uptime() });
});
</code></pre>
                    </div>
                </div>
            </section>

            <section id="estaticos-templates" tabindex="-1">
                <h2>Archivos estáticos y motores de plantillas</h2>
                <div class="grid cols-2">
                    <div class="card">
                        <h3>Estáticos</h3>
                        <pre><button class="copy">Copiar</button><code>app.use('/static', express.static('public')); // GET /static/logo.png
</code></pre>
                    </div>
                    <div class="card">
                        <h3>EJS/Pug (SSR)</h3>
                        <pre><button class="copy">Copiar</button><code>// npm i ejs
app.set('view engine', 'ejs');
app.set('views', './views');
app.get('/hello', (req,res) =&gt; res.render('hello', { name:'Express' }));
// views/hello.ejs =&gt; &lt;h1&gt;Hola &lt;%= name %&gt;&lt;/h1&gt;
</code></pre>
                    </div>
                </div>
            </section>

            <section id="db" tabindex="-1">
                <h2>Integración con bases de datos</h2>
                <div class="grid cols-2">
                    <div class="card">
                        <h3>MongoDB con Mongoose</h3>
                        <pre><button class="copy">Copiar</button><code>// npm i mongoose
const mongoose = require('mongoose');
mongoose.connect(process.env.MONGO_URI).then(() =&gt; console.log('Mongo OK'));

const UserSchema = new mongoose.Schema({
  email: { type:String, unique:true, required:true },
  name: String
},{ timestamps:true });

const User = mongoose.model('User', UserSchema);

app.get('/users', async (req,res,next) =&gt; {
  try { res.json(await User.find()); } catch(e){ next(e); }
});
</code></pre>
                    </div>
                    <div class="card">
                        <h3>PostgreSQL con Prisma</h3>
                        <pre><button class="copy">Copiar</button><code># npm i -D prisma &amp;&amp; npm i @prisma/client
# npx prisma init
# .env =&gt; DATABASE_URL="postgresql://user:pass@localhost:5432/miapi?schema=public"
# prisma/schema.prisma:
# model Product { id Int @id @default(autoincrement()) name String price Int }

# npx prisma migrate dev --name init
// uso:
const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();
app.get('/products', async (req,res) =&gt; res.json(await prisma.product.findMany()));
</code></pre>
                    </div>
                </div>
            </section>

            <section id="uploads" tabindex="-1">
                <h2>Subida de archivos</h2>
                <pre><button class="copy">Copiar</button><code>// npm i multer
const multer = require('multer');
const upload = multer({ dest:'uploads/', limits:{ fileSize: 5 * 1024 * 1024 } });

app.post('/upload', upload.single('file'), (req,res) =&gt; {
  res.json({ file: req.file });
});
</code></pre>
            </section>

            <section id="testing" tabindex="-1">
                <h2>Pruebas</h2>
                <p>Usa Jest y Supertest para probar endpoints.</p>
                <pre><button class="copy">Copiar</button><code>// npm i -D jest supertest
// tests/app.test.js
const request = require('supertest');
const app = require('../src/app');

test('GET /health', async () =&gt; {
  const res = await request(app).get('/health');
  expect(res.statusCode).toBe(200);
  expect(res.body.ok).toBe(true);
});
</code></pre>
            </section>

            <section id="logging" tabindex="-1">
                <h2>Logging</h2>
                <div class="grid cols-2">
                    <div class="card">
                        <h3>Morgan</h3>
                        <pre><button class="copy">Copiar</button><code>const morgan = require('morgan');
app.use(morgan(process.env.NODE_ENV === 'production' ? 'combined' : 'dev'));
</code></pre>
                    </div>
                    <div class="card">
                        <h3>Winston</h3>
                        <pre><button class="copy">Copiar</button><code>// npm i winston
const { createLogger, transports, format } = require('winston');
const logger = createLogger({
  level: 'info',
  format: format.combine(format.timestamp(), format.json()),
  transports: [ new transports.Console() ]
});
logger.info('Servidor iniciando...');
</code></pre>
                    </div>
                </div>
            </section>

            <section id="rendimiento" tabindex="-1">
                <h2>Rendimiento y escalado</h2>
                <ul>
                    <li>Activar compresión (gzip/br)</li>
                    <li>Cachear respuestas idempotentes</li>
                    <li>Evitar trabajo bloqueante (usar colas/servicios)</li>
                    <li>Escalar horizontalmente con PM2/cluster</li>
                </ul>
                <pre><button class="copy">Copiar</button><code>// npm i compression
const compression = require('compression');
app.use(compression());

// Cache-control
app.get('/publico', (req,res) =&gt; {
  res.set('Cache-Control', 'public, max-age=300');
  res.json({ now: Date.now() });
});

// Cluster (archivo separado)
const cluster = require('cluster');
const os = require('os');
if(cluster.isPrimary){
  const cpus = os.cpus().length;
  for(let i=0;i&lt;cpus;i++) cluster.fork();
  cluster.on('exit', () =&gt; cluster.fork());
} else {
  // require('./server');
}
</code></pre>
            </section>

            <section id="deploy" tabindex="-1">
                <h2>Despliegue</h2>
                <div class="grid cols-2">
                    <div class="card">
                        <h3>PM2 (producción)</h3>
                        <pre><button class="copy">Copiar</button><code># npm i -g pm2
pm2 start server.js --name mi-api
pm2 save
pm2 startup
</code></pre>
                    </div>
                    <div class="card">
                        <h3>Docker</h3>
                        <pre><button class="copy">Copiar</button><code># Dockerfile
FROM node:20-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
ENV NODE_ENV=production
EXPOSE 3000
CMD ["node","server.js"]
</code></pre>
                    </div>
                </div>
                <div class="card" style="margin-top:12px">
                    <h3>Nginx (reverse proxy)</h3>
                    <pre><button class="copy">Copiar</button><code># /etc/nginx/conf.d/mi-api.conf
server {
  listen 80;
  server_name ejemplo.com;
  location / {
    proxy_pass http://127.0.0.1:3000;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header Host $host;
  }
}
</code></pre>
                </div>
            </section>

            <section id="buenas-practicas" tabindex="-1">
                <h2>Buenas prácticas</h2>
                <ul>
                    <li>Usa versiones LTS y dependencias actualizadas</li>
                    <li>Divide responsabilidades (rutas/controladores/servicios)</li>
                    <li>Valida todo input externo</li>
                    <li>Maneja errores de forma consistente</li>
                    <li>Config por entorno, no por código</li>
                    <li>Logs estructurados (JSON) en producción</li>
                    <li>Automatiza pruebas y CI</li>
                    <li>Observabilidad: métricas y tracing</li>
                </ul>
            </section>

            <section id="troubleshooting" tabindex="-1">
                <h2>Troubleshooting</h2>
                <ul>
                    <li>Error EADDRINUSE: cambia el puerto o libera el proceso que lo usa</li>
                    <li>CORS bloqueado: revisa cabeceras y credenciales</li>
                    <li>req.body vacío: faltan middlewares de parseo</li>
                    <li>JWT inválido: verifica secreto/expiración y reloj del servidor</li>
                    <li>Conexión a DB: revisa cadena, firewall, credenciales</li>
                </ul>
            </section>

            <section id="faq" tabindex="-1">
                <h2>FAQ</h2>
                <h3>¿Express es adecuado para producción?</h3>
                <p>Sí, con las configuraciones correctas (seguridad, logs, escalado, tests).</p>
                <h3>¿Debería usar TypeScript?</h3>
                <p>Recomendado para bases de código medianas/grandes por tipado y DX.</p>
                <h3>¿Express o Fastify?</h3>
                <p>Fastify rinde mejor en alto throughput; Express tiene mayor ecosistema y simplicidad.</p>
            </section>

            <section id="recursos" tabindex="-1">
                <h2>Recursos</h2>
                <ul>
                    <li>Documentación oficial: https://expressjs.com/</li>
                    <li>Guía de seguridad Node: https://nodejs.org/en/docs/guides/security/</li>
                    <li>Mongoose: https://mongoosejs.com/</li>
                    <li>Prisma: https://www.prisma.io/</li>
                </ul>
            </section>

            <footer>
                Hecho para introducir Express.js en Backend • Actualiza dependencias y verifica vulnerabilidades con
                "npm audit".
            </footer>
        </main>
    </div>

    <script>
        // Copiar código
        document.querySelectorAll('pre').forEach(pre =& gt; {
            const btn = pre.querySelector('.copy');
            if (!btn) return;
            btn.addEventListener('click', async() =& gt; {
                const text = pre.querySelector('code')?.innerText ?? '';
                try {
                    await navigator.clipboard.writeText(text);
                    btn.textContent = 'Copiado';
                    setTimeout(() =& gt; btn.textContent = 'Copiar', 1500);
                } catch { btn.textContent = 'Error'; }
            });
        });

        // TOC activo por sección visible
        const links = [...document.querySelectorAll('#toc a')];
        const map = new Map(links.map(a =& gt;[a.getAttribute('href').slice(1), a]));
        const obs = new IntersectionObserver((entries) =& gt; {
            entries.forEach(e =& gt; {
                if (e.isIntersecting) {
                    links.forEach(l =& gt; l.classList.remove('active'));
                    const a = map.get(e.target.id);
                    if (a) a.classList.add('active');
                }
            });
        }, { rootMargin: '-40% 0px -55% 0px', threshold: 0.01 });

        document.querySelectorAll('main section[id]').forEach(s =& gt; obs.observe(s));

        // Búsqueda simple por títulos y contenido
        const search = document.getElementById('search');
        search?.addEventListener('input', () =& gt; {
            const q = search.value.trim().toLowerCase();
            const sections = [...document.querySelectorAll('main section')];
            sections.forEach(sec =& gt; {
                const hit = sec.innerText.toLowerCase().includes(q);
                sec.style.display = hit ? '' : 'none';
            });
        });

        // Scroll suave
        document.querySelectorAll('a[href^="#"]').forEach(a =& gt; {
            a.addEventListener('click', (e) =& gt; {
                const id = a.getAttribute('href').slice(1);
                const sec = document.getElementById(id);
                if (sec) {
                    e.preventDefault();
                    const top = sec.offsetTop - 64;
                    window.scrollTo({ top, behavior: 'smooth' });
                }
            });
        });
    </script>
</body>

</html>